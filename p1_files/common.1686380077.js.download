async function waitFor(t){for(;1!=t.done;)await new Promise((t=>setTimeout(t,100)))}function getBrowserWidth(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}function getBrowserHeight(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function isWindowClosable(){return!!window.opener&&window.opener.location.host==window.location.host}function isElementInViewport(t){"function"==typeof jQuery&&t instanceof jQuery&&(t=t[0]);var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}function dynamicallyLoadScript(t){var e=document.createElement("script");e.src=t,document.head.appendChild(e)}async function uploadWithProgress(t,e,n,o,i){var r=new XMLHttpRequest;r.onerror=t=>{toastr.error("Your internet connection appears to be broken."),o(this.status,this.statusText)},(r.upload||r).addEventListener("progress",i),r.addEventListener("load",(function(t){this.status>=200&&this.status<=299?n(JSON.parse(this.responseText)):o(this.status,this.statusText)})),r.open("POST",t,!0),r.send(e)}async function postDataAsJson(t="",e={}){const n=await fetch(t,{method:"POST",mode:"no-cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(e)}).catch((t=>{toastr.error("Network error.")}));if(n.status>=200&&n.status<=299){return await n.json()}{const t=await n.text();throw toastr.error(t),n}}async function postDataAsForm(t="",e={}){const n=await fetch(t,{method:"POST",mode:"no-cors",cache:"no-cache",credentials:"same-origin",redirect:"follow",referrerPolicy:"no-referrer",body:e}).catch((t=>{toastr.error("Network error.")}));if(n.ok){return await n.json()}{const t=await n.text();throw toastr.error(t),t}}async function doFetchGet(t){const e=await fetch(t,{method:"GET",mode:"no-cors",cache:"no-cache",credentials:"same-origin",redirect:"follow",referrerPolicy:"no-referrer"}).catch((t=>{toastr.error("Network error.")}));if(e.ok){return await e.json()}{const t=await e.text();throw toastr.error(t),e}}function validateRadioButton(t,e){let n=sprintf("input:radio[name='{0}']:checked",t);return 1==$(n).length||(toastr.error(e),!1)}function strlenBySize(t){var e=t.match(/[\u0000-\u007f]/g),n=e?e.length:0,o=encodeURI(t.replace(/[\u0000-\u007f]/g)).match(/%/g);return n+2*(o?o.length:0)/3}function minBySize(t,e,n){return strlenBySize(t)>=n}function maxBySize(t,e,n){return strlenBySize(t)<=n}function isInStandaloneMode(){return window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone}function doPwaAdjustment(){isInStandaloneMode()&&(setSessionCookie("stdaln","1"),$("a[target][onclick^='ow']").removeAttr("onclick"))}var decodeHtmlEntity=function(t){return t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(e)}))},encodeHtmlEntity=function(t){for(var e=[],n=t.length-1;n>=0;n--)e.unshift(["&#",t[n].charCodeAt(),";"].join(""));return e.join("")};function ow(t){window.open("",t).focus()}function nl2br(t,e){return(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(e||void 0===e?"<br />":"<br>")+"$2")}function isLocalStorageGood(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}function isLocal(){return window.location.hostname.endsWith("rolia.local")}function print(t){document.write(t)}function println(t){print(t),document.write("<br>\r\n")}function sprintf(t){var e=Array.prototype.slice.call(arguments,1);return t.replace(/{(\d+)}/g,(function(t,n){return void 0!==e[n]?e[n]:t}))}function nano(t,e){return t.replace(/\{([\w\.]*)\}/g,(function(t,n){for(var o=n.split("."),i=e[o.shift()],r=0,a=o.length;r<a;r++)i=i[o[r]];return null!=i?i:""}))}function trimString(t){return(t=this!=window?this:t).replace(/^\s+/g,"").replace(/\s+$/g,"")}function patternMatch(t,e){t=t.trim();var n=new RegExp(e,"");return null!=t.match(n)}function checkboxToText(t,e){for(var n="",o="",i=document.getElementById(e),r=document.getElementsByName(t),a=0;a<r.length;a++)r[a].checked&&(n=n+o+r[a].value,o="| ");""!=n&&(i.value=n)}function fetchHtml(t,e){$.ajax({url:t,type:"GET",success:function(t){t&&toastr.info(t)},error:function(t,e,n){toastr.error(t.responseText)}})}function getSiteKey(){return location.hostname.split(".").reverse().pop()}function getDomain(){let t=location.hostname.split(".").reverse();t.pop();return t.reverse().join(".")}function setCookie(t,e,n){const o=getDomain(),i=new Date;i.setDate(i.getDate()+n);const r=i.toUTCString(),a=escape(e);document.cookie=`${t}=${a};expires=${r};domain=.${o};path=/`}function setSessionCookie(t,e){const n=getDomain(),o=escape(e);document.cookie=`${t}=${o};domain=.${n};path=/`}function getCookie(t){var e,n,o,i=document.cookie.split(";");for(e=0;e<i.length;e++)if(n=i[e].substr(0,i[e].indexOf("=")),o=i[e].substr(i[e].indexOf("=")+1),(n=n.replace(/^\s+|\s+$/g,""))==t)return unescape(o);return null}function createCookie(t,e,n){setCookie(t,e,n)}function readCookie(t){return getCookie(t)}function eraseCookie(t){createCookie(t,"",-1)}function faIcon(t){return"<i class='fa fa-"+t+"'></i>"}function resizeIframeByDoc(t){var e,n,o=document.getElementById(t);e=o.contentWindow.document.body.scrollHeight,n=o.contentWindow.document.body.scrollWidth,o.height=e+"px",o.width=n+"px"}function checkIfInView(t){var e=t.offset().top-$(window).scrollTop();return!(e>window.innerHeight)||($("html,body").animate({scrollTop:e},1e3),!1)}function scrollToAnchor(t){var e=$("a[name='"+t+"']"),n=e.offset().top-$(window).scrollTop();(n<0||n>window.innerHeight)&&$("html,body").animate({scrollTop:e.offset().top},"slow")}function scrollToId(t){var e=$("#"+t).offset();e&&$("html, body").animate({scrollTop:e.top-100},500)}function scrollToElement(t){$(window).scrollTop(t.offset().top).scrollLeft(t.offset().left)}function formatDate(t){return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+"T"+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}function setupTimezone(){var t=formatDate(new Date);$.ajax({url:"/util/ajaxSetupTimezoneCookie.php?t="+t,type:"GET",success:function(t){var e=getCookie("tzSetupCount");e=e?parseInt(e):0,setSessionCookie("tzSetupCount",++e),setCookie("tzOffsetMin",t,365)},error:function(t,e,n){}})}function checkTimezone(){var t=getCookie("tzOffsetMin");if(t||setupTimezone(),t!=0-(new Date).getTimezoneOffset()){var e=getCookie("tzSetupCount");(e=e?parseInt(e):0)<2e3?setupTimezone():console.log("Your local timezone setting may be incorrect.")}}function is_touch_device(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}function hideLoading(){return $("#loading-div").css("display","none"),$("#loading-mask-div").css("display","none"),!0}function showLoading(){return!0}function hBack(t,e){t=t||"/";var n=window.location.href;window.history.go(e),setTimeout((function(){window.location.href==n&&(window.location.href=t)}),500)}function initQr(){$(document).on("click",".show-qr",(function(t){t.preventDefault(),$(".post-qr").show()}))}function initCncurl(){$(document).on("click",".cncurl_url",(function(t){t.preventDefault();var e=t.target,n=$(e).parent().children(".cncurl_copied");iosCopyToClipboard(e);var o=e.getBoundingClientRect();n.css({top:o.top+20,left:o.left+10}),n.fadeIn(300).delay(3e3).fadeOut(500)}))}function initForumModeSetters(){const t=window.location.pathname.startsWith("/f/topic.php");var e=()=>{var t=window.location.href;t=(t=t.replace(".php?v=p&",".php?")).replace(".php?",".php?v=t&"),window.location.href=t},n=()=>{var t=window.location.href;t=(t=t.replace(".php?v=t&",".php?")).replace(".php?",".php?v=p&"),window.location.href=t};$(document).on("click",".view-modes .to-tree-view",(function(n){t?e():doFetchGet("/api/common/treeMode").then((()=>{e()}))})),$(document).on("click",".view-modes .to-panel-view",(function(e){t?n():doFetchGet("/api/common/panelMode").then((()=>{n()}))}))}function initStickyNavBar(){var t=document.getElementById("stickyNavBar");if(null!=t){window.stickyNavBarOffsetTop=t.offsetTop,window.onscroll=function(){toggleStickyNavBar()};$("<div class='btn-group'><button class='btn btn-default scrollup2 hidden' ><i class='fa fa-arrow-up'></i></button></div>").insertBefore("#stickyNavBar>.pull-right"),$("#stickyNavBar .scrollup2").click((function(){return $("html, body").animate({scrollTop:0},600),!1}))}}function toggleStickyNavBar(){var t=document.getElementById("stickyNavBar"),e=$("#stickyNavBar .scrollup2");window.pageYOffset>=window.stickyNavBarOffsetTop?t.classList.add("bar-is-sticky"):t.classList.remove("bar-is-sticky"),window.pageYOffset>=window.stickyNavBarOffsetTop+500?e.removeClass("hidden"):e.addClass("hidden")}function iosCopyToClipboard(t){var e=t.contentEditable,n=t.readOnly,o=document.createRange();t.contentEditable=!0,t.readonly=!1,o.selectNodeContents(t);var i=window.getSelection();i.removeAllRanges(),i.addRange(o),t.setSelectionRange(0,9999),t.contentEditable=e,t.readOnly=n,document.execCommand("copy")}function isReload(){return window.performance&&"reload"==window.performance.getEntriesByType("navigation")[0].type}function doneWaiting(){$("#waiting-div").remove()}function showWaiting(t){const e=`\n\t\t<div id=waiting-div>\n\t\t\t<div class='panel panel-info' id='waiting-msg'>\n\t\t\t\t<div class='panel-body'>\n\t\t\t\t\t<i class='fa fa-spin fa-spinner mr20'></i>${t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div id='waiting-mask'></div>\n\t\t</div>\n\t`;$("body").append(e);var n=$(document).height(),o=$(window).width(),i=$(window).height(),r=$(window).width();const a=r>480?.6*r:r-20;return $("#waiting-mask").css({"z-index":1e4,position:"fixed",top:0,left:0,width:o,height:n,display:"block","background-color":"#000",opacity:.8}),$("#waiting-msg").css({"z-index":10001,position:"fixed",width:a,display:"block"}),$("#waiting-msg").css({top:i/2-$("#waiting-msg").height()/2,left:r/2-$("#waiting-msg").width()/2}),!0}function popupMsg(t,e="info"){toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-center",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:0,extendedTimeOut:0,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",tapToDismiss:!1};var n=toastr[e](`${t}<br /><br /><button type="button" class="btn btn-default clear">OK</button>`);n.find(".clear").length&&n.delegate(".clear","click",(function(){toastr.clear(n,{force:!0})})),toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-center",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:3333,extendedTimeOut:1,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",tapToDismiss:!0}}function toastr_warning(t){toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-center",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:0,extendedTimeOut:0,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",tapToDismiss:!1};var e=toastr.warning(`${t}<br /><br /><button type="button" class="btn btn-default clear">OK</button>`);e.find(".clear").length&&e.delegate(".clear","click",(function(){toastr.clear(e,{force:!0})})),toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-center",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:3333,extendedTimeOut:1,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",tapToDismiss:!0}}function initSite(){const t=document.documentElement,e=getSiteKey();[480,768,1024,1280,1920,""].forEach((n=>{t.style.setProperty(`--wp${n}`,`url("/images/site/${e}/wp${n}.jpg")`)}))}function initCommon(){const t=".adsbygoogle";var e=200,n=200;const o=()=>{document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)};window.addEventListener("resize",o),o();(()=>{let t=window.innerWidth;t<1600&&$(".spr-xl-only").remove(),t>=768&&$(".spr-phone-only").remove(),t<768&&$(".spr-no-phone").remove()})();$(document).on("click",".social-media-share",(async function(t){t=t||window.event;const e=$('meta[property="og:url"]').attr("content"),n=$('meta[property="og:title"]').attr("content");if(navigator.share)try{await navigator.share({title:"",url:e,text:n})}catch(t){}else navigator.clipboard.writeText(e).then((function(){toastr.success(roliaMsg.url_copied)}),(function(){toastr.error("Your browser does not support this feature.")}));return!0}));var i=setInterval((function(){e-- >0?($(t).css("z-index",1),$(t).css("display","block !important")):clearInterval(i)}),100);var r=setInterval((function(){n-- >0?($(".ob-widget-pub-manager-bar").css("display","none"),$(".ob-widget-pub-manager").css("display","none")):clearInterval(r)}),100)}String.format||(String.format=function(t){var e=Array.prototype.slice.call(arguments,1);return t.replace(/{(\d+)}/g,(function(t,n){return void 0!==e[n]?e[n]:t}))}),String.endsWith||(String.prototype.endsWith=function(t){var e=this.lastIndexOf(t);return-1!==e&&e+t.length===this.length}),String.prototype.trim=trimString,sanitizeFileName=t=>t.replace(/[ @#]/g,"_").replace(/['"\\/~`!$%^&*(){}\[\]|;:<>?,]/g,"").substring(0,255),initCncurl(),initQr(),$(document).on("click",".confirm",(function(t){return confirm("Please confirm the opeartion:")})),$(".dropdown").on("click",".close",(function(){$(this).removeClass("open")})),$(document).on("click","a[href]:not([target])",(function(t){if(!(t=t||window.event).ctrlKey&&!t.metaKey){var e=t.target,n=$(e).attr("href"),o=window.location.href.split("#")[0];return void 0===n||n.startsWith("javascript")||n.startsWith("#")||n.startsWith(o+"#")||showLoading(),!0}})),$(document).ready((function(){initCommon(),doPwaAdjustment(),initStickyNavBar(),initForumModeSetters()})),checkTimezone();var _isOpera=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,_isFirefox="undefined"!=typeof InstallTrigger,_isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||"[object SafariRemoteNotification]"===(!window.safari||safari.pushNotification).toString(),_isIE=!!document.documentMode,_isEdge=!_isIE&&!!window.StyleMedia,_isChrome=!!window.chrome&&!!window.chrome.webstore,_isBlink=(_isChrome||_isOpera)&&!!window.CSS,_isIOS=navigator.userAgent.startsWith("Mozilla/5.0 (iP"),_isIphone=navigator.userAgent.startsWith("Mozilla/5.0 (iPhone"),_isCriOS=null!=String.prototype.includes&&navigator.userAgent.includes("CriOS");const _isPhone=window.innerWidth<768;