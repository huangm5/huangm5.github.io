function initPanoImg(){$("img.user-image.pano").each(((t,e)=>{const o="pano"+$(e).data("ino"),n=$(e).attr("src");$(e).before(`<div id='${o}' class='pano-holder'></div>`),pannellum.viewer(o,{autoLoad:!0,panorama:n}),$(e).hide()}))}function limitFileSize(t,e){var o=t.target,n=o.files[0],a=n.size,i=Math.round(10*a/1024/1024)/10;if(i>e){var r=sprintf("The size of the selected file '{0}' is {1}MB.  It's larger than the limit of {2}MB and cannot be uploaded.",n.name,i,e);$(o).val(""),toastr.error(r)}}function resizeImage(t,e){var o=1024,n=null,a=null,i=function(t,e,n){var a,i,r,s,l,c,f=e.getContext("2d"),u=t.width,d=t.height;return n?(a=96,i=96,u>d?(r=(u-d)/2,s=0,l=d,c=d):(r=0,s=0,l=u,c=u)):u>o?(a=o,i=d*o/u):(a=u,i=d),e.width=a,e.height=i,n?f.drawImage(t,r,s,l,c,0,0,a,i):f.drawImage(t,0,0,a,i),e},r=function(t){var e=";base64,";if(-1==t.indexOf(e)){var o=(a=t.split(","))[0].split(":")[1],n=a[1];return new Blob([n],{type:o})}o=(a=t.split(e))[0].split(":")[1];for(var a,i=(n=window.atob(a[1])).length,r=new Uint8Array(i),s=0;s<i;++s)r[s]=n.charCodeAt(s);return new Blob([r],{type:o})},s=new FileReader;s.onload=function(t){var o=new Image;o.onload=function(t){var s=!1,l=document.createElement("canvas");anvas=i(o,l,s);var c=l.toDataURL("image/jpeg");n=r(c),s=!0;var f=document.createElement("canvas"),u=(f=i(o,f,s)).toDataURL("image/png");a=r(u);var d=function(t,e){var o={};return o.iBlob=t,o.tBlob=e,o}(n,a);e(d)},o.src=t.target.result},s.readAsDataURL(t)}function TopicView(){var t=function(t){const e=$(t).closest("ul.topic"),o=$(t).closest("li"),n=(o.data("pno"),o.parent().prev("li.post")),a=n.data("pno"),i=o.prevAll();e.find("li.post>div.contents").addClass("dataOnly"),o.find(">div.contents").removeClass("dataOnly"),e.find("li.post.focus").removeClass("focus"),o.addClass("focus"),e.find("li.post.parent").removeClass("parent"),n.addClass("parent"),$(i).size()>0?(o.prevAll("li.ellipsisLi").remove(),$(i).hide(300),o.before("<li class='ellipsisLi'><i class='fa fa-ellipsis-h ellipsis'></i></li>"),$("#p"+a).get(0).scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})):1==n.length&&$("#p"+a).get(0).scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},e=()=>{$(document).on("click",".toggle-contents",(function(t){t.preventDefault();$(this).closest("li").find(">div.contents").toggleClass("dataOnly")})),$(document).on("click",".go-ura",(function(t){t.preventDefault();$(this).closest("ul.topic").find(".ura").get(0).scrollIntoView({behavior:"smooth",block:"center"})})),$(document).on("click","ul.topic ul.post>li.post:not(:first-child)>u:first-child",(function(e){e.preventDefault(),t(this)})),$(document).on("click",".ellipsisLi",(function(t){t.preventDefault(),$(this).prevAll().show(1e3),$(this).remove()}))};!function(){if(e(),"undefined"!=typeof initFocusPno){var o=document.getElementById("p"+initFocusPno);t(o)}}()}_PLUSONE=t=>0,$(document).on("click",".buttonPlusOne",(function(t){t.preventDefault(),$(this).hide();var e=$(this).closest("li").data("pno"),o=new FormData;return o.append("f",fno),o.append("p",e),postDataAsForm("/api/f/plusOne",o).then((t=>{const o=$("li#p"+e+">span.plusOneCount");""==t?o.fadeOut().fadeIn():o.html("+"+t)})),!1})),FlfService=function(){},FlfService.copyTopicUrl=function(t,e){const o=`https://${location.hostname}/f/topic.php?v=p&f=${t}&t=${e}`;navigator.clipboard.writeText(o).then((function(){toastr.success(roliaMsg.topic_url_copied)}),(function(){toastr.error("Your browser does not support this feature.")}))},FlfService.bookmark=function(t){Bookmark.add(t,FlfService.bookmarkDone)},FlfService.unbookmark=function(t){Bookmark.remove(t,FlfService.unbookmarkDone)},FlfService.bookmarkDone=function(t){var e=sprintf("ul.topic[data-tno='{0}']",t);$(e).attr("data-bookmarked","true"),$(e).find(">li.post>.post-title").before("<span class='bookmarked'><i class='fa fa-bookmark-o'></i></span>")},FlfService.unbookmarkDone=function(t){var e=sprintf("ul.topic[data-tno='{0}']",t);$(e).attr("data-bookmarked","false"),$(e).find(">li.post>.bookmarked").remove()},FlfService.follow=function(t){FollowUser.follow(t,FlfService.followDone)},FlfService.unfollow=function(t){FollowUser.unfollow(t,FlfService.unfollowDone)},FlfService.followDone=function(t){var e=sprintf("li.post[data-author='{0}']",t);$(e).attr("data-following","true"),$(e).addClass("following")},FlfService.unfollowDone=function(t){var e=sprintf("li.post[data-author='{0}']",t);$(e).attr("data-following","false"),$(e).removeClass("following")},FlfService.ignore=function(t){IgnoreUser.ignore(t,FlfService.ignoreDone)},FlfService.unignore=function(t){IgnoreUser.unignore(t,FlfService.unignoreDone)},FlfService.ignoreDone=function(t){var e=sprintf("li.post[data-author='{0}']",t);$(e).attr("data-ignoring","true"),$(e).addClass("ignoring")},FlfService.unignoreDone=function(t){var e=sprintf("li.post[data-author='{0}']",t);$(e).attr("data-ignoring","false"),$(e).removeClass("ignoring")},FoldThread=function(){},FoldThread.fold=function(t){var e=sprintf("/lf/ajaxLf.php?action=foldThread&f={0}&t={1}&c={2}&b={3}",fno,t,_cno,_bno),o=$.ajax({url:e,type:"GET"});o.done((function(e,o,n){$("#t"+t).html(e),toastr.success("Topic folded")})),o.fail((function(t,e,o){toastr.error(o)}))},FoldThread.unfold=function(){},_BOOKMARK=t=>0,Bookmark=function(){},Bookmark.add=function(t,e){var o=sprintf("/f/ajaxForum.php?action=addBm&f={0}&t={1}",fno,t),n=$.ajax({url:o,type:"GET"});n.done((function(o,n,a){toastr.success(o),void 0!==e&&e(t)})),n.fail((function(t,e,o){toastr.error(o)}))},Bookmark.remove=function(t,e){var o=sprintf("/f/ajaxForum.php?action=delBm&f={0}&t={1}",fno,t),n=$.ajax({url:o,type:"GET"});n.done((function(o,n,a){toastr.success(o),void 0!==e&&e(t)})),n.fail((function(t,e,o){toastr.error(o)}))},_PANORAMIC_IMAGES=t=>0,_USERIMAGEV1=t=>0,function(){UserImageV1=function(){},UserImageV1.hide=function(o){var n=t(o);e(n,0)},UserImageV1.show=function(o){var n=t(o);e(n,1)};var t=function(t){return $(t).parent("div.userImageControl").prevAll("img[src^='/upImg']").attr("src").match(/\/upImg\/.+?\/(\d+)\.jpg/)[1]},e=function(t,e){var n=sprintf("/mem/ajaxMem.php?action=toggleUserImageV1&i={0}&show={1}",t,e),a=$.ajax({url:n,type:"GET"});a.done((function(e,n,a){toastr.success(e),o(t)})),a.fail((function(t,e,o){toastr.error(o)}))},o=function(t){var e=sprintf("/upImg/{0}/{1}.jpg",userid,t),o=e+"?"+(new Date).getTime();$("img[src^='"+e+"']").attr("src",o)};window.UserImageV1=UserImageV1}(),_USERIMAGEV2=t=>0,function(){var t;UserImageV2=function(){},UserImageV2.hide=function(t){var n=e(t);o(n,0)},UserImageV2.show=function(t){var n=e(t);o(n,1)};var e=function(e){var o=$(e).parent("div.uiV2control").prevAll(`img[src^='/uiV2/${userid}~']`);return t=o.attr("src"),o.attr("src").match(/\/uiV2\/[a-z0-9._-]{2,20}~(\d+)~.{4}\.jpg/)[1]},o=function(t,e){var o=new FormData;o.append("i",t),o.append("show",e),postDataAsForm("/api/asset/toggleUserImageV2",o).then((e=>{toastr.success(e),n(t)}))},n=function(e){let o=t;var n=o+"?"+(new Date).getTime();$("img[src^='"+o+"']").attr("src",n)};window.UserImageV2=UserImageV2}(),_TOPIC_VIEW=t=>0;var isPanelView,hash=window.location.hash;$((function(){new TopicView,isPanelView=!$("#topicsTreeView").length,initPanoImg();let t=userid||"@public@";$(`.contents img[src^='/uiV2/${t}~']`).after("\n\t\t<div class='uiV2control'>\n\t\t\t<button onclick=UserImageV2.hide(this) class='hide-image fa fa-eye-slash btn btn-default'>Hide</button> \n\t\t\t<button onclick=UserImageV2.show(this) class='show-image fa fa-eye       btn btn-default'>Show</button> \n\t\t</div>\n\t")}));